<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Probation review report</title>
  <meta name="description" content="Probation review report">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="Probation review report" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="ellessenne/prr" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Probation review report" />
  
  
  

<meta name="author" content="Alessandro Gasparini">


<meta name="date" content="2017-08-21">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="smre.html">
<link rel="next" href="smre-shared-frailty.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />










<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="terminology-notation.html"><a href="terminology-notation.html"><i class="fa fa-check"></i><b>1</b> Terminology and notation</a></li>
<li class="chapter" data-level="2" data-path="smre.html"><a href="smre.html"><i class="fa fa-check"></i><b>2</b> Survival models with random effects</a><ul>
<li class="chapter" data-level="2.1" data-path="smre-univariate-frailty.html"><a href="smre-univariate-frailty.html"><i class="fa fa-check"></i><b>2.1</b> Univariate frailty models</a></li>
<li class="chapter" data-level="2.2" data-path="smre-shared-frailty.html"><a href="smre-shared-frailty.html"><i class="fa fa-check"></i><b>2.2</b> Shared frailty models</a></li>
<li class="chapter" data-level="2.3" data-path="smre-random-effects.html"><a href="smre-random-effects.html"><i class="fa fa-check"></i><b>2.3</b> Alternative formulation</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="jm.html"><a href="jm.html"><i class="fa fa-check"></i><b>3</b> Joint models for longitudinal and survival data</a><ul>
<li class="chapter" data-level="3.1" data-path="jm-formulation.html"><a href="jm-formulation.html"><i class="fa fa-check"></i><b>3.1</b> Model formulation</a></li>
<li class="chapter" data-level="3.2" data-path="jm-estimation.html"><a href="jm-estimation.html"><i class="fa fa-check"></i><b>3.2</b> Estimation process</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="compch.html"><a href="compch.html"><i class="fa fa-check"></i><b>4</b> Computational challenges in survival models with random effects</a><ul>
<li class="chapter" data-level="4.1" data-path="compch-numintgr.html"><a href="compch-numintgr.html"><i class="fa fa-check"></i><b>4.1</b> Numerical integration</a><ul>
<li class="chapter" data-level="4.1.1" data-path="compch-numintgr.html"><a href="compch-numintgr.html#compch-numintgr-uni"><i class="fa fa-check"></i><b>4.1.1</b> Unidimensional functions</a></li>
<li class="chapter" data-level="4.1.2" data-path="compch-numintgr.html"><a href="compch-numintgr.html#compch-numintgr-multi"><i class="fa fa-check"></i><b>4.1.2</b> Multidimensional functions</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="compch-numdiff.html"><a href="compch-numdiff.html"><i class="fa fa-check"></i><b>4.2</b> Numerical differentiation</a></li>
<li class="chapter" data-level="4.3" data-path="compch-numroot.html"><a href="compch-numroot.html"><i class="fa fa-check"></i><b>4.3</b> Numerical root finding</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="simsurv.html"><a href="simsurv.html"><i class="fa fa-check"></i><b>5</b> Simulating survival data</a></li>
<li class="chapter" data-level="6" data-path="simst1.html"><a href="simst1.html"><i class="fa fa-check"></i><b>6</b> Simulation study: accuracy of Gaussian quadrature</a><ul>
<li class="chapter" data-level="6.1" data-path="simst1-aim.html"><a href="simst1-aim.html"><i class="fa fa-check"></i><b>6.1</b> Aim</a></li>
<li class="chapter" data-level="6.2" data-path="simst1-dgms.html"><a href="simst1-dgms.html"><i class="fa fa-check"></i><b>6.2</b> Data-generating mechanisms</a></li>
<li class="chapter" data-level="6.3" data-path="simst1-methods.html"><a href="simst1-methods.html"><i class="fa fa-check"></i><b>6.3</b> Methods</a></li>
<li class="chapter" data-level="6.4" data-path="simst1-est.html"><a href="simst1-est.html"><i class="fa fa-check"></i><b>6.4</b> Estimands</a></li>
<li class="chapter" data-level="6.5" data-path="simst1-pm.html"><a href="simst1-pm.html"><i class="fa fa-check"></i><b>6.5</b> Performance measures</a></li>
<li class="chapter" data-level="6.6" data-path="simst1-res.html"><a href="simst1-res.html"><i class="fa fa-check"></i><b>6.6</b> Results</a><ul>
<li class="chapter" data-level="6.6.1" data-path="simst1-res.html"><a href="simst1-res.html#aim-1-comparison-of-gaussian-quadrature-with-analytical-formulae"><i class="fa fa-check"></i><b>6.6.1</b> Aim 1: comparison of Gaussian quadrature with analytical formulae</a></li>
<li class="chapter" data-level="6.6.2" data-path="simst1-res.html"><a href="simst1-res.html#aim-2-accuracy-when-analytical-formulae-are-not-available"><i class="fa fa-check"></i><b>6.6.2</b> Aim 2: accuracy when analytical formulae are not available</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="simst1-conclusions.html"><a href="simst1-conclusions.html"><i class="fa fa-check"></i><b>6.7</b> Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="simst2.html"><a href="simst2.html"><i class="fa fa-check"></i><b>7</b> Simulation study: impact of misspecification in survival models with shared frailty terms</a><ul>
<li class="chapter" data-level="7.1" data-path="simst2-aim.html"><a href="simst2-aim.html"><i class="fa fa-check"></i><b>7.1</b> Aim</a></li>
<li class="chapter" data-level="7.2" data-path="simst2-dgms.html"><a href="simst2-dgms.html"><i class="fa fa-check"></i><b>7.2</b> Data-generating mechanisms</a></li>
<li class="chapter" data-level="7.3" data-path="simst2-methods.html"><a href="simst2-methods.html"><i class="fa fa-check"></i><b>7.3</b> Methods</a></li>
<li class="chapter" data-level="7.4" data-path="simst2-est.html"><a href="simst2-est.html"><i class="fa fa-check"></i><b>7.4</b> Estimands</a></li>
<li class="chapter" data-level="7.5" data-path="simst2-pm.html"><a href="simst2-pm.html"><i class="fa fa-check"></i><b>7.5</b> Performance measures</a></li>
<li class="chapter" data-level="7.6" data-path="simst2-res.html"><a href="simst2-res.html"><i class="fa fa-check"></i><b>7.6</b> Results</a></li>
<li class="chapter" data-level="7.7" data-path="simst2-conclusions.html"><a href="simst2-conclusions.html"><i class="fa fa-check"></i><b>7.7</b> Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="sirex.html"><a href="sirex.html"><i class="fa fa-check"></i><b>8</b> Exploring results from simulation studies interactively</a></li>
<li class="chapter" data-level="9" data-path="infvp.html"><a href="infvp.html"><i class="fa fa-check"></i><b>9</b> Informative visiting process</a></li>
<li class="chapter" data-level="10" data-path="future.html"><a href="future.html"><i class="fa fa-check"></i><b>10</b> Future research developments</a></li>
<li class="chapter" data-level="11" data-path="pdevelop.html"><a href="pdevelop.html"><i class="fa fa-check"></i><b>11</b> Personal development</a><ul>
<li class="chapter" data-level="11.1" data-path="supervisory-meetings.html"><a href="supervisory-meetings.html"><i class="fa fa-check"></i><b>11.1</b> Supervisory meetings</a></li>
<li class="chapter" data-level="11.2" data-path="training-and-courses.html"><a href="training-and-courses.html"><i class="fa fa-check"></i><b>11.2</b> Training and courses</a></li>
<li class="chapter" data-level="11.3" data-path="conferences.html"><a href="conferences.html"><i class="fa fa-check"></i><b>11.3</b> Conferences</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="ax-tables.html"><a href="ax-tables.html"><i class="fa fa-check"></i><b>A</b> Tables</a></li>
<li class="chapter" data-level="B" data-path="ax-plots.html"><a href="ax-plots.html"><i class="fa fa-check"></i><b>B</b> Plots</a></li>
<li class="chapter" data-level="C" data-path="ax-slides.html"><a href="ax-slides.html"><i class="fa fa-check"></i><b>C</b> Slides</a><ul>
<li class="chapter" data-level="C.1" data-path="ax-slides-safjr.html"><a href="ax-slides-safjr.html"><i class="fa fa-check"></i><b>C.1</b> 2017 SAfJR Conference</a></li>
<li class="chapter" data-level="C.2" data-path="ax-slides-sam-iscb.html"><a href="ax-slides-sam-iscb.html"><i class="fa fa-check"></i><b>C.2</b> 2017 SAM Conference and ISCB Conference</a></li>
<li class="chapter" data-level="C.3" data-path="ax-slides-students-day.html"><a href="ax-slides-students-day.html"><i class="fa fa-check"></i><b>C.3</b> Studentsâ€™ Day at the 2017 ISCB Conference</a></li>
</ul></li>
<li class="chapter" data-level="D" data-path="ax-manuscript.html"><a href="ax-manuscript.html"><i class="fa fa-check"></i><b>D</b> Manuscript draft</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Probation review report</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="smre-univariate-frailty" class="section level2">
<h2><span class="header-section-number">2.1</span> Univariate frailty models</h2>
<p>In those settings where risk factors are not measured, their relevance is unknown, or it is not known whether such risk factor exist at all or not, it is useful to consider two sources of variability in survival analysis: variability accounted for by observable risk factors included in the model and heterogeneity caused by unknown covariates. The unobserved heterogeneity is described by the frailty term, which is assumed to follow some distribution. Formally: <span class="math display">\[
h(t|\alpha) = \alpha h_0(t),
\]</span> where <span class="math inline">\(\alpha\)</span> is a non-observed frailty effect and <span class="math inline">\(h_0(t)\)</span> is the baseline hazard function. The random variable <span class="math inline">\(\alpha\)</span>, the frailty term, is chosen to have a distribution <span class="math inline">\(f(\alpha)\)</span> with expectation <span class="math inline">\(E(\alpha) = 1\)</span> and variance <span class="math inline">\(V(\alpha) = \sigma ^ 2\)</span>. <span class="math inline">\(V(\alpha)\)</span> is interpretable as a measure of heterogeneity across the population in baseline risk: as <span class="math inline">\(\sigma ^ 2\)</span> increases the values of <span class="math inline">\(\alpha\)</span> are more dispersed, with greater heterogeneity in <span class="math inline">\(\alpha h_0(t)\)</span>. Underlying assumptions are: the frailty is time independent, and it acts multiplicatively on the underlying baseline hazard function.</p>
<p>Introducing observed covariates into the model: <span class="math display">\[
h(t|X,\alpha) = \alpha h_0(t) \exp(X \beta) = \alpha h(t | X),
\]</span> with <span class="math inline">\(X\)</span> and <span class="math inline">\(\beta\)</span> covariates and regression coefficients, respectively. Given the relationship between hazard and survival function, it can be showed that the individual survival function conditional on the frailty is <span class="math inline">\(S(t | \alpha) = S(t) ^ \alpha\)</span>. The population (i.e.Â marginal, or unconditional) survival function is obtained by integrating out the frailty from the conditional survival function: <span class="math display">\[
S(t) = \int_0^{+\infty} \left[ S(t) \right] ^ \alpha f(\alpha) \ d\alpha
\]</span></p>
<p>The individual contribution to the likelihood (assuming no delayed entry) is conditional on the unobserved frailty <span class="math inline">\(\alpha\)</span> <span class="math display">\[
L_i = \prod_{i = 1} ^ {n} \left( \alpha h_0(t_i)\exp(X_i \beta) \right) ^ {d_i} \exp(-\alpha H_0(t_i) \exp(X_i \beta)),
\]</span> with <span class="math inline">\(d_i\)</span> event indicator variable, <span class="math inline">\(H_0(t_i)\)</span> cumulative baseline hazard, and <span class="math inline">\(t_i\)</span> observed survival time - all relative to the <span class="math inline">\(i\)</span>-th individual.</p>
<p>Different choices for the frailty distribution are possible. Assigning a probability distribution implies that the frailty can be integrated out of the likelihood function. After this integration, the likelihood can be maximized in the usual way if its explicit form exists. Otherwise, more sophisticated approaches like numerical integration or Markov Chain Monte Carlo methods are required. The most often used frailty distributions are the gamma and the log-normal distribution; the positive stable and the inverse Gaussian distribution are also common.</p>
<p>Assuming that the frailty <span class="math inline">\(\alpha\)</span> has a Gamma distribution is convenient: it has the appropriate range <span class="math inline">\((0, \infty)\)</span> and it is mathematically tractable. A Gamma distribution with parameters <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> has density <span class="math display">\[
f(x) = \frac{x ^ {a - 1} \exp(- x / b)}{\Gamma(a)b ^ a};
\]</span> by choosing <span class="math inline">\(a = 1 / \theta\)</span> and <span class="math inline">\(b = \theta\)</span> the resulting distribution has expectation <span class="math inline">\(1\)</span> and finite variance <span class="math inline">\(\theta\)</span>. In these settings, the model is analytically tractable: the population survival function has the form <span class="math display">\[
S(t) = (1 - \theta \log(S(t))) ^ {-1/\theta};
\]</span> the likelihood follows by substitution. Estimating such model becomes therefore straightforward, which likely contributed to the popularity of Gamma frailty models.</p>
<p>Together with the Gamma distribution, the log-normal distribution is the most commonly used frailty distribution, given its strong ties to random effect models; more on that in Section <a href="smre-random-effects.html#smre-random-effects">2.3</a>. Hence, assuming a log-normal distribution with a single parameter <span class="math inline">\(\theta &gt; 0\)</span> (for comparison with the mathematically tractable Gamma frailty model) with density <span class="math display">\[
f(x) = (2 \pi \theta) ^ {-\frac{1}{2}} x ^ {-1} \exp \left( -\frac{(\log x) ^ 2}{2 \theta} \right),
\]</span> the resulting model has a frailty whose expectation is finite. Nevertheless, this frailty distribution cannot be integrated out of the survival function analytically to obtain the population survival function or the likelihood.</p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="smre.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="smre-shared-frailty.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["Probation_review_report_AG.pdf"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
