<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Probation review report</title>
  <meta name="description" content="Probation review report">
  <meta name="generator" content="bookdown 0.4 and GitBook 2.6.7">

  <meta property="og:title" content="Probation review report" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="ellessenne/prr" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Probation review report" />
  
  
  

<meta name="author" content="Alessandro Gasparini">


<meta name="date" content="2017-08-07">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="smre.html">
<link rel="next" href="smre-shared-frailty.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #0000ff; } /* Keyword */
code > span.ch { color: #008080; } /* Char */
code > span.st { color: #008080; } /* String */
code > span.co { color: #008000; } /* Comment */
code > span.ot { color: #ff4000; } /* Other */
code > span.al { color: #ff0000; } /* Alert */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #008000; font-weight: bold; } /* Warning */
code > span.cn { } /* Constant */
code > span.sc { color: #008080; } /* SpecialChar */
code > span.vs { color: #008080; } /* VerbatimString */
code > span.ss { color: #008080; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { } /* Variable */
code > span.cf { color: #0000ff; } /* ControlFlow */
code > span.op { } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #ff4000; } /* Preprocessor */
code > span.do { color: #008000; } /* Documentation */
code > span.an { color: #008000; } /* Annotation */
code > span.cv { color: #008000; } /* CommentVar */
code > span.at { } /* Attribute */
code > span.in { color: #008000; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="sa.html"><a href="sa.html"><i class="fa fa-check"></i><b>1</b> Introduction to survival analysis</a><ul>
<li class="chapter" data-level="1.1" data-path="sa-survdata.html"><a href="sa-survdata.html"><i class="fa fa-check"></i><b>1.1</b> Survival data</a></li>
<li class="chapter" data-level="1.2" data-path="sa-censoring.html"><a href="sa-censoring.html"><i class="fa fa-check"></i><b>1.2</b> Censoring</a></li>
<li class="chapter" data-level="1.3" data-path="sa-terminology-notation.html"><a href="sa-terminology-notation.html"><i class="fa fa-check"></i><b>1.3</b> Terminology and notation</a></li>
<li class="chapter" data-level="1.4" data-path="sa-estsurv.html"><a href="sa-estsurv.html"><i class="fa fa-check"></i><b>1.4</b> Estimation of the survival function</a></li>
<li class="chapter" data-level="1.5" data-path="sa-parsa.html"><a href="sa-parsa.html"><i class="fa fa-check"></i><b>1.5</b> Parametric survival models</a><ul>
<li class="chapter" data-level="1.5.1" data-path="sa-parsa.html"><a href="sa-parsa.html#sa-parsa-distributions"><i class="fa fa-check"></i><b>1.5.1</b> Failure time distributions</a></li>
<li class="chapter" data-level="1.5.2" data-path="sa-parsa.html"><a href="sa-parsa.html#sa-parsa-estimation"><i class="fa fa-check"></i><b>1.5.2</b> Estimation procedure</a></li>
<li class="chapter" data-level="1.5.3" data-path="sa-parsa.html"><a href="sa-parsa.html#sa-parsa-example"><i class="fa fa-check"></i><b>1.5.3</b> Data analysis example</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="sa-cox.html"><a href="sa-cox.html"><i class="fa fa-check"></i><b>1.6</b> The Cox proportional hazards model</a><ul>
<li class="chapter" data-level="1.6.1" data-path="sa-cox.html"><a href="sa-cox.html#sa-cox-estimation"><i class="fa fa-check"></i><b>1.6.1</b> Estimation procedure</a></li>
<li class="chapter" data-level="1.6.2" data-path="sa-cox.html"><a href="sa-cox.html#sa-cox-estimating-survival"><i class="fa fa-check"></i><b>1.6.2</b> Estimating the survival function</a></li>
<li class="chapter" data-level="1.6.3" data-path="sa-cox.html"><a href="sa-cox.html#sa-model-assumptions"><i class="fa fa-check"></i><b>1.6.3</b> Model assumptions</a></li>
<li class="chapter" data-level="1.6.4" data-path="sa-cox.html"><a href="sa-cox.html#sa-cox-example"><i class="fa fa-check"></i><b>1.6.4</b> Data analysis example</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="sa-advances.html"><a href="sa-advances.html"><i class="fa fa-check"></i><b>1.7</b> Advances in survival analysis</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="smre.html"><a href="smre.html"><i class="fa fa-check"></i><b>2</b> Survival models with random effects</a><ul>
<li class="chapter" data-level="2.1" data-path="smre-univariate-frailty.html"><a href="smre-univariate-frailty.html"><i class="fa fa-check"></i><b>2.1</b> Univariate frailty models</a></li>
<li class="chapter" data-level="2.2" data-path="smre-shared-frailty.html"><a href="smre-shared-frailty.html"><i class="fa fa-check"></i><b>2.2</b> Shared frailty models</a></li>
<li class="chapter" data-level="2.3" data-path="smre-random-effects.html"><a href="smre-random-effects.html"><i class="fa fa-check"></i><b>2.3</b> Alternative formulation</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="jm.html"><a href="jm.html"><i class="fa fa-check"></i><b>3</b> Joint models for longitudinal and survival data</a></li>
<li class="chapter" data-level="4" data-path="compch.html"><a href="compch.html"><i class="fa fa-check"></i><b>4</b> Computational challenges in survival models with random effects</a></li>
<li class="chapter" data-level="5" data-path="simst1.html"><a href="simst1.html"><i class="fa fa-check"></i><b>5</b> Simulation study: accuracy of Gaussian quadrature</a><ul>
<li class="chapter" data-level="5.1" data-path="simst1-aim.html"><a href="simst1-aim.html"><i class="fa fa-check"></i><b>5.1</b> Aim</a></li>
<li class="chapter" data-level="5.2" data-path="simst1-dgms.html"><a href="simst1-dgms.html"><i class="fa fa-check"></i><b>5.2</b> Data-generating mechanisms</a></li>
<li class="chapter" data-level="5.3" data-path="simst1-methods.html"><a href="simst1-methods.html"><i class="fa fa-check"></i><b>5.3</b> Methods</a></li>
<li class="chapter" data-level="5.4" data-path="simst1-est.html"><a href="simst1-est.html"><i class="fa fa-check"></i><b>5.4</b> Estimands</a></li>
<li class="chapter" data-level="5.5" data-path="simst1-pm.html"><a href="simst1-pm.html"><i class="fa fa-check"></i><b>5.5</b> Performance measures</a></li>
<li class="chapter" data-level="5.6" data-path="simst1-res.html"><a href="simst1-res.html"><i class="fa fa-check"></i><b>5.6</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="simst2.html"><a href="simst2.html"><i class="fa fa-check"></i><b>6</b> Simulation study: impact of misspecification in survival models with shared frailty terms</a><ul>
<li class="chapter" data-level="6.1" data-path="simst2-aim.html"><a href="simst2-aim.html"><i class="fa fa-check"></i><b>6.1</b> Aim</a></li>
<li class="chapter" data-level="6.2" data-path="simst2-dgms.html"><a href="simst2-dgms.html"><i class="fa fa-check"></i><b>6.2</b> Data-generating mechanisms</a></li>
<li class="chapter" data-level="6.3" data-path="simst2-methods.html"><a href="simst2-methods.html"><i class="fa fa-check"></i><b>6.3</b> Methods</a></li>
<li class="chapter" data-level="6.4" data-path="simst2-est.html"><a href="simst2-est.html"><i class="fa fa-check"></i><b>6.4</b> Estimands</a></li>
<li class="chapter" data-level="6.5" data-path="simst2-pm.html"><a href="simst2-pm.html"><i class="fa fa-check"></i><b>6.5</b> Performance measures</a></li>
<li class="chapter" data-level="6.6" data-path="simst2-res.html"><a href="simst2-res.html"><i class="fa fa-check"></i><b>6.6</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="sirex.html"><a href="sirex.html"><i class="fa fa-check"></i><b>7</b> Exploring results from simulation studies interactively</a></li>
<li class="chapter" data-level="8" data-path="infvp.html"><a href="infvp.html"><i class="fa fa-check"></i><b>8</b> Informative visiting process</a></li>
<li class="chapter" data-level="9" data-path="future.html"><a href="future.html"><i class="fa fa-check"></i><b>9</b> Future research developments</a></li>
<li class="chapter" data-level="10" data-path="pdevelop.html"><a href="pdevelop.html"><i class="fa fa-check"></i><b>10</b> Personal development</a><ul>
<li class="chapter" data-level="10.1" data-path="supervisory-meetings.html"><a href="supervisory-meetings.html"><i class="fa fa-check"></i><b>10.1</b> Supervisory meetings</a></li>
<li class="chapter" data-level="10.2" data-path="training-and-courses.html"><a href="training-and-courses.html"><i class="fa fa-check"></i><b>10.2</b> Training and courses</a></li>
<li class="chapter" data-level="10.3" data-path="conferences.html"><a href="conferences.html"><i class="fa fa-check"></i><b>10.3</b> Conferences</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="ax-slides.html"><a href="ax-slides.html"><i class="fa fa-check"></i><b>A</b> Slides</a></li>
<li class="chapter" data-level="B" data-path="ax-manuscript.html"><a href="ax-manuscript.html"><i class="fa fa-check"></i><b>B</b> Manuscript</a></li>
<li class="chapter" data-level="C" data-path="ax-r-session.html"><a href="ax-r-session.html"><i class="fa fa-check"></i><b>C</b> R Session</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Probation review report</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="smre-univariate-frailty" class="section level2">
<h2><span class="header-section-number">2.1</span> Univariate frailty models</h2>
<p>In those settings where risk factors are not measured, their relevance is unknown, or it is not known whether such risk factor exist at all or not, it is useful to consider two sources of variability in survival analysis: variability accounted for by observable risk factors included in the model and heterogeneity caused by unknown covariates. The unobserved heterogeneity is described by the frailty term, which is assumed to follow some distribution. Formally: <span class="math display">\[
h(t|\alpha) = \alpha h_0(t),
\]</span> where <span class="math inline">\(\alpha\)</span> is a non-observed frailty effect and <span class="math inline">\(h_0(t)\)</span> is the baseline hazard function. The random variable <span class="math inline">\(\alpha\)</span>, the frailty term, is chosen to have a distribution <span class="math inline">\(f(\alpha)\)</span> with expectation <span class="math inline">\(E(\alpha) = 1\)</span> and variance <span class="math inline">\(V(\alpha) = \sigma ^ 2\)</span>. <span class="math inline">\(V(\alpha)\)</span> is interpretable as a measure of heterogeneity across the population in baseline risk: as <span class="math inline">\(\sigma ^ 2\)</span> increases the values of <span class="math inline">\(\alpha\)</span> are more dispersed, with greater heterogeneity in <span class="math inline">\(\alpha h_0(t)\)</span>. Underlying assumptions are: the frailty is time independent, and it acts multiplicatively on the underlying baseline hazard function.</p>
<p>Introducing observed covariates into the model: <span class="math display">\[
h(t|X,\alpha) = \alpha h_0(t) \exp(X \beta) = \alpha h(t | X),
\]</span> with <span class="math inline">\(X\)</span> and <span class="math inline">\(\beta\)</span> covariates and regression coefficients, respectively. Given the relationship between hazard and survival function, it can be showed that the individual survival function conditional on the frailty is <span class="math inline">\(S(t | \alpha) = S(t) ^ \alpha\)</span>. The population (i.e. marginal, or unconditional) survival function is obtained by integrating out the frailty from the conditional survival function: <span class="math display">\[
S(t) = \int_0^{+\infty} \left[ S(t) \right] ^ \alpha f(\alpha) \ d\alpha
\]</span></p>
<p>The individual contribution to the likelihood (assuming no delayed entry) is conditional on the unobserved frailty <span class="math inline">\(\alpha\)</span> <span class="math display">\[
L_i = \prod_{i = 1} ^ {n} \left( \alpha h_0(t_i)\exp(X_i \beta) \right) ^ {d_i} \exp(-\alpha H_0(t_i) \exp(X_i \beta)),
\]</span> with <span class="math inline">\(d_i\)</span> event indicator variable, <span class="math inline">\(H_0(t_i)\)</span> cumulative baseline hazard, and <span class="math inline">\(t_i\)</span> observed survival time - all relative to the <span class="math inline">\(i\)</span>-th individual.</p>
<p>Different choices for the frailty distribution are possible. Assigning a probability distribution implies that the frailty can be integrated out of the likelihood function. After this integration, the likelihood can be maximized in the usual way if an explicit form of it exists. Otherwise, more sophisticated approaches like numerical integration or Markov Chain Monte Carlo methods need to be applied. The most often used frailty distributions are the gamma and the log-normal distribution; the positive stable and the inverse Gaussian distribution are also common.</p>
<p>Assuming that the frailty <span class="math inline">\(\alpha\)</span> has a Gamma distribution is convenient: it has the appropriate range <span class="math inline">\((0, \infty)\)</span> and it is mathematically tractable. A Gamma distribution with parameters <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> has density <span class="math display">\[
f(x) = \frac{x ^ {a - 1} \exp(- x / b)}{\Gamma(a)b ^ a};
\]</span> by choosing <span class="math inline">\(a = 1 / \theta\)</span> and <span class="math inline">\(b = \theta\)</span> the resulting distribution has expectation <span class="math inline">\(1\)</span> and finite variance <span class="math inline">\(\theta\)</span>. In these settings, the model is analytically tractable: the population survival function has the form <span class="math display">\[
S(t) = (1 - \theta \log(S(t))) ^ {-1/\theta};
\]</span> the likelihood follows by substitution. Estimating such model becomes therefore straightforward, which likely contributed to the popularity of Gamma frailty models.</p>
<p>Together with the Gamma distribution, the log-normal distribution is the most commonly used frailty distribution, given its strong ties to random effect models; more on that in Section <a href="smre-random-effects.html#smre-random-effects">2.3</a>. Hence, assuming a log-normal distribution with a single parameter <span class="math inline">\(\theta &gt; 0\)</span> (for comparison with the mathematically tractable Gamma frailty model), with density <span class="math display">\[
f(x) = (2 \pi \theta) ^ {-\frac{1}{2}} x ^ {-1} \exp \left( -\frac{(\log x) ^ 2}{2 \theta} \right),
\]</span> the resulting model has a frailty whose expectation is finite. Nevertheless, this frailty distribution cannot be integrated out of the survival function analytically to obtain the population survival function, and therefore requires more complex estimation procedures involving numerical integration (taking the maximum likelihood approach), mathematical approximations (such as the Laplace approximation), or Markov Chain Monte Carlo methods <span class="citation">(Clayton <a href="#ref-clayton_1991">1991</a>; Sinha et al. <a href="#ref-sinha_2008">2008</a>)</span>. Further details in Chapter <a href="compch.html#compch">4</a>.</p>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-clayton_1991">
<p>Clayton, David G. 1991. “A Monte Carlo Method for Bayesian Inference in Frailty Models.” <em>Biometrics</em> 47 (2): 467. doi:<a href="https://doi.org/10.2307/2532139">10.2307/2532139</a>.</p>
</div>
<div id="ref-sinha_2008">
<p>Sinha, Debajyoti, Tapabrata Maiti, Joseph G Ibrahim, and Bichun Ouyang. 2008. “Current Methods for Recurrent Events Data with Dependent Termination.” <em>Journal of the American Statistical Association</em> 103 (482): 866–78. doi:<a href="https://doi.org/10.1198/016214508000000201">10.1198/016214508000000201</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="smre.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="smre-shared-frailty.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["Probation_review_report_AG.pdf", "Probation_review_report_AG.epub", "Probation_review_report_AG.mobi"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
